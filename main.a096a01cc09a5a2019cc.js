!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){return void 0===t?(this.x=0,void(this.y=0)):void 0===e?(this.x=t,void(this.y=t)):(this.x=t,void(this.y=e))}return t.prototype.added=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.subtracted=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.multiplied=function(e){return new t(this.x*e,this.y*e)},t.prototype.divided=function(e){return new t(this.x/e,this.y/e)},t.prototype.magnitudeSqr=function(){return this.x*this.x+this.y*this.y},t.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSqr())},t.prototype.distance=function(t){return this.subtracted(t).magnitude()},t.prototype.rotated=function(e){var n=Math.cos(e),o=Math.sin(e);return new t(this.x*n-this.y*o,this.x*o+this.y*n)},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.normalized=function(){return this.divided(this.magnitude())},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.enabled=!0,this.removeFromGameObject=function(){}}return Object.defineProperty(t.prototype,"gameObject",{get:function(){if(null==this._gameObject)throw new Error("GameObject not attached");return this._gameObject},enumerable:!1,configurable:!0}),t.prototype.start=function(t){this._gameObject=t,this.onStart()},t.prototype.setRemoveFunction=function(t){this.removeFromGameObject=t},t.prototype.destroy=function(){this.onDestroy(),this.removeFromGameObject()},t}();e.default=o},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentColliders=[],e.collidedThisFrame=[],e.observerManager=new s,e.unSubscribe=function(){},e}return r(e,t),Object.defineProperty(e.prototype,"isColliding",{get:function(){return this.currentColliders.length>0},enumerable:!1,configurable:!0}),e.prototype.onCollision=function(t){this.currentColliders.includes(t.otherCollider)||(this.currentColliders.push(t.otherCollider),this.observerManager.onCollisionStart(t)),this.collidedThisFrame.push(t.otherCollider),this.observerManager.onCollisionStay(t)},e.prototype.update=function(){var t=this;this.currentColliders.forEach((function(e){if(!t.collidedThisFrame.includes(e)){t.observerManager.onCollisionExit(e);var n=t.currentColliders.indexOf(e);t.currentColliders.splice(n,1)}})),this.collidedThisFrame=[]},e.prototype.onStart=function(){if(null==this.gameObject.scene)throw new Error("No scene");this.gameObject.scene.subscribeCollider(this)},e.prototype.draw=function(){},e.prototype.observe=function(t){return this.observerManager.addObserver(t)},e.prototype.subscribed=function(t){this.unSubscribe=t},e.prototype.onDestroy=function(){this.unSubscribe()},e.prototype.debugDraw=function(t,e){this.isColliding?t.setStrokeStyle([255,0,0]):t.setStrokeStyle([0,255,0]),t.drawShape(this.getPoints())},e}(n(1).default);e.default=i;var s=function(){function t(){this.observers=[]}return t.prototype.forEachObserver=function(t){this.observers.forEach((function(e){e.enabled&&t(e)}))},t.prototype.addObserver=function(t){var e=this;return this.observers.push(t),function(){if(e.observers.includes(t)&&null!=t){var n=e.observers.indexOf(t);e.observers.splice(n,1)}}},t.prototype.onCollisionStart=function(t){this.forEachObserver((function(e){return e.onCollisionStart(t)}))},t.prototype.onCollisionStay=function(t){this.forEachObserver((function(e){return e.onCollisionStay(t)}))},t.prototype.onCollisionExit=function(t){this.forEachObserver((function(e){return e.onCollisionExit(t)}))},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(4).default("main")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(5);e.default=function(t){var e=document.getElementById(t);if(null==e)throw new Error("Could not find element with specified id");e.innerHTML="",e.appendChild(o.default)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(6),i=n(12),s=document.createElement("canvas"),a=new o.default(window.innerWidth,window.innerHeight);s.width=a.x,s.height=2*a.y/3;var u=new r.default(s);i.default(u),e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),r=n(8),i=n(9),s=n(10),a=n(11),u=n(0),c=function(){function t(t){this.lastFrameTime=0,this.drawer=new o.default(t),this.gameObjectManager=new r.default(this),this.collisionManager=new i.default(this,new a.default),this.canvasDimensions=new u.default(t.width,t.height),this.startLoop=this.startLoop.bind(this)}return t.prototype.draw=function(t){this.drawer.setFillColor([0,0,0]),this.drawer.fillRect(new u.default,this.canvasDimensions),this.gameObjectManager.draw(t),s.default.DEBUG&&this.collisionManager.debugDraw(t)},t.prototype.update=function(t){this.gameObjectManager.update(t),this.collisionManager.update(t)},t.prototype.startLoop=function(t){var e=t-this.lastFrameTime;this.update(e),this.draw(e),this.lastFrameTime=t,window.requestAnimationFrame(this.startLoop)},t.prototype.instantiate=function(t){this.gameObjectManager.instantiate(t)},t.prototype.subscribeCollider=function(t){this.collisionManager.subscribe(t)},t}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this.canvas=t;var e=t.getContext("2d");if(null==e)throw new Error("Could not get canvas rendering context");this.ctx=e}return t.prototype.setStrokeStyle=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1),this.ctx.strokeStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+e+")",this.ctx.lineWidth=n},t.prototype.setFillColor=function(t,e){void 0===e&&(e=1),this.ctx.fillStyle="rgba("+t[0]+","+t[1]+","+t[2]+","+e+")"},t.prototype.drawLine=function(t,e){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke()},t.prototype.fillRect=function(t,e){this.ctx.fillRect(t.x,t.y,e.x,e.y)},t.prototype.drawShape=function(t){var e=this;this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y),t.forEach((function(t){e.ctx.lineTo(t.x,t.y)})),this.ctx.closePath(),this.ctx.stroke()},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){this.scene=t,this.gameObjects=[]}return t.prototype.instantiate=function(t){var e=this;t.addToScene(this.scene,(function(){if(e.gameObjects.includes(t)&&null!=t){var n=e.gameObjects.indexOf(t);e.gameObjects.splice(n,1)}})),this.gameObjects.push(t)},t.prototype.draw=function(t){var e=this;this.gameObjects.forEach((function(n){return n.draw(e.scene.drawer,t)}))},t.prototype.update=function(t){this.gameObjects.forEach((function(e){return e.update(t)}))},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){this.scene=t,this.strategy=e,this.colliders=[]}return t.prototype.subscribe=function(t){var e=this;t.subscribed((function(){if(e.colliders.includes(t)&&null!=t){var n=e.colliders.indexOf(t);e.colliders.splice(n,1)}})),this.colliders.push(t)},t.prototype.debugDraw=function(t){var e=this;this.forEachCollider((function(n){return n.debugDraw(e.scene.drawer,t)}))},t.prototype.update=function(t){var e=this;this.forEachPairOfColliders((function(t,n){var o=e.strategy.getCollisionVector(t,n);null!=o&&(t.onCollision({collider:t,otherCollider:n,collisionVector:o}),n.onCollision({collider:n,otherCollider:t,collisionVector:o.multiplied(-1)}))}))},t.prototype.forEachCollider=function(t){this.colliders.forEach((function(e){e.enabled&&t(e)}))},t.prototype.forEachPairOfColliders=function(t){for(var e=0;e<this.colliders.length;e++)for(var n=e+1;n<this.colliders.length;n++){var o=this.colliders[e],r=this.colliders[n];o.enabled&&r.enabled&&t(o,r)}},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={DEBUG:!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){function t(){}return t.prototype.getIntersectionDirection=function(t,e){if(t.max<e.min||t.min>e.max)return null;var n=[e.min-t.max,e.max-t.min];return this.returnNearestFromZero(n)},t.prototype.returnNearestFromZero=function(t){var e=1/0;return t.forEach((function(t){Math.abs(t)<Math.abs(e)&&(e=t)})),e},t.prototype.getAxesProjections=function(t,e){var n=1/0,o=-1/0;return t.forEach((function(t){var r=e.dot(t);r<n&&(n=r),r>o&&(o=r)})),{min:n,max:o}},t.prototype.getCollisionVector=function(t,e){var n=[];n.push.apply(n,t.getAxes()),n.push.apply(n,e.getAxes());for(var r=[t.getPoints(),e.getPoints()],i={vector:new o.default,magnitude:1/0},s=0;s<n.length;s++){var a=n[s],u=[this.getAxesProjections(r[0],a),this.getAxesProjections(r[1],a)],c=this.getIntersectionDirection(u[0],u[1]);if(null==c)return null;Math.abs(c)<Math.abs(i.magnitude)&&(i={vector:a.multiplied(c),magnitude:c})}return i.vector},t}();e.default=r},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),s=n(15),a=n(0),u=n(1),c=n(16);function l(t,e){var n=new i.default,o=new c.default(new a.default,[new a.default,new a.default(100,75),new a.default(40,100),new a.default(10,100),new a.default(-10,80)]),r=new f;n.transform.position=e.clone(),n.addComponent(o),n.addComponent(r),o.observe(r),t.instantiate(n)}e.default=function(t){var e=new i.default,n=new s.default({position:new a.default(0,-100),dimensions:new a.default(50,500)});e.transform.position=new a.default(500,50),e.addComponent(n),t.instantiate(e),l(t,new a.default(0,100)),l(t,new a.default(50,110)),t.startLoop(0)};var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.time=0,e.rotationRate=0,e}return r(e,t),e.prototype.onCollisionStart=function(t){},e.prototype.onCollisionStay=function(t){this.gameObject.transform.position=this.gameObject.transform.position.added(t.collisionVector.multiplied(1))},e.prototype.onCollisionExit=function(t){},e.prototype.onStart=function(){this.rotationRate=500*Math.random()+500},e.prototype.update=function(t){this.time+=t/100,this.gameObject.transform.position.x+=t/10,this.gameObject.transform.rotation+=t/this.rotationRate},e.prototype.draw=function(t,e){},e.prototype.onDestroy=function(){},e}(u.default)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(14),r=function(){function t(){this.components=[],this.destroyFunc=function(){throw new Error("Destroy function not given")},this.transform=new o.default,this.addComponent(this.transform)}return t.prototype.forEachComponent=function(t){this.components.forEach((function(e){e.enabled&&t(e)}))},t.prototype.update=function(t){this.forEachComponent((function(e){return e.update(t)}))},t.prototype.draw=function(t,e){this.forEachComponent((function(n){return n.draw(t,e)}))},t.prototype.onDestroy=function(){this.forEachComponent((function(t){return t.onDestroy()}))},t.prototype.addComponent=function(t){var e=this;this.components.push(t),t.setRemoveFunction((function(){if(e.components.includes(t)&&null!=t){var n=e.components.indexOf(t);e.components.splice(n,1)}}))},t.prototype.addToScene=function(t,e){var n=this;this.scene=t,this.destroyFunc=e,this.components.forEach((function(t){return t.start(n)}))},t.prototype.destroy=function(){this.forEachComponent((function(t){return t.destroy()})),this.onDestroy(),this.destroyFunc()},t}();e.default=r},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),s=function(t){function e(){var e=t.call(this)||this;return e.position=new i.default,e.rotation=0,e.scale=new i.default(1),e}return r(e,t),e.prototype.onStart=function(){},e.prototype.update=function(){},e.prototype.draw=function(){},e.prototype.onDestroy=function(){},e}(n(1).default);e.default=s},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),s=n(0),a=function(t){function e(e){var n=t.call(this)||this;return n.rectangle=e,n}return r(e,t),e.prototype.getPosition=function(){return this.gameObject.transform.position.added(this.rectangle.position)},e.prototype.getDimensions=function(){return new s.default(this.gameObject.transform.scale.x*this.rectangle.dimensions.x,this.gameObject.transform.scale.y*this.rectangle.dimensions.y)},e.prototype.getAxes=function(){var t=[new s.default(1,0),new s.default(0,1)],e=this.gameObject.transform.rotation;return[t[0].rotated(e),t[1].rotated(e)]},e.prototype.getPoints=function(){var t=this.getDimensions(),e=this.gameObject.transform.rotation;return[this.rectangle.position.rotated(e).added(this.gameObject.transform.position),this.rectangle.position.added(new s.default(t.x,0)).rotated(e).added(this.gameObject.transform.position),this.rectangle.position.added(t).rotated(e).added(this.gameObject.transform.position),this.rectangle.position.added(new s.default(0,t.y)).rotated(e).added(this.gameObject.transform.position)]},e}(i.default);e.default=a},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n){var o=t.call(this)||this;return o.center=e,o.points=n,o}return r(e,t),e.prototype.getAxes=function(){for(var t=[],e=this.getPoints(),n=0;n<e.length;n++){var o=e[(n+1)%e.length].subtracted(e[n]);t.push(o.rotated(Math.PI/2).normalized())}return t},e.prototype.getPoints=function(){var t=this;return this.points.map((function(e){return e.subtracted(t.center).rotated(t.gameObject.transform.rotation).added(t.center).added(t.gameObject.transform.position)}))},e}(n(2).default);e.default=i}]);